package com.vk2.touchsreentab.model.datasource;import android.arch.paging.PageKeyedDataSource;import android.content.Context;import android.support.annotation.NonNull;import android.util.Log;import com.vk2.touchsreentab.api.ApiController;import com.vk2.touchsreentab.api.Callback;import com.vk2.touchsreentab.database.entity.Singer;import com.vk2.touchsreentab.database.entity.Song;import com.vk2.touchsreentab.model.ResultSinger;import com.vk2.touchsreentab.model.api.SingerForm;import com.vk2.touchsreentab.model.api.SongForm;import com.vk2.touchsreentab.utils.Constants;import java.util.List;import io.reactivex.Observable;import io.reactivex.Observer;import io.reactivex.android.schedulers.AndroidSchedulers;import io.reactivex.disposables.Disposable;import io.reactivex.schedulers.Schedulers;public class SingerDataSource extends PageKeyedDataSource<Integer, Singer> {    private Context context;    private int page = 1, limit = 15;    SingerDataSource(Context context) {        this.context = context;    }    @Override    public void loadInitial(@NonNull LoadInitialParams<Integer> params, @NonNull final LoadInitialCallback<Integer, Singer> callback) {        ApiController.getInstance().getHotSingers(context, page, limit, new Callback() {            @Override            public void response(Object obj) {                try {                    SingerForm singerForm = (SingerForm) obj;                    if (singerForm != null) {                        if (singerForm.getErr() == ApiController.SUCCESS) {                            List<Singer> singers = singerForm.getData();                            if (singers != null) {                                callback.onResult(singers, page--, page++);                                page++;                            }                        }                    }                } catch (ClassCastException e) {                    e.printStackTrace();                }            }        });    }    @Override    public void loadBefore(@NonNull LoadParams<Integer> params, @NonNull LoadCallback<Integer, Singer> callback) {    }    @Override    public void loadAfter(@NonNull LoadParams<Integer> params, @NonNull final LoadCallback<Integer, Singer> callback) {        ApiController.getInstance().getHotSingers(context, page, limit, new Callback() {            @Override            public void response(Object obj) {                try {                    SingerForm singerForm = (SingerForm) obj;                    if (singerForm != null) {                        if (singerForm.getErr() == ApiController.SUCCESS) {                            List<Singer> singers = singerForm.getData();                            if (singers != null && singers.size() > 0) {                                callback.onResult(singers, page);                                page++;                            }                        }                    }                } catch (ClassCastException e) {                    e.printStackTrace();                }            }        });    }}